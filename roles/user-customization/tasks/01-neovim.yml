---
- name: "Clone nvim repo"
  ansible.builtin.git:
    repo: 'https://github.com/neovim/neovim'
    version: release-0.10
    dest: "{{ nvim.repo_path }}"

- name: "Build project with CMake (Release mode)"
  ansible.builtin.command:
    cmd: make CMAKE_BUILD_TYPE=Release
    chdir: "{{ nvim.repo_path }}"
    creates: "{{ nvim.repo_path }}/build"

- name: "Install the built project"
  ansible.builtin.command:
    cmd: make install
    chdir: "{{ nvim.repo_path }}"
    creates: "{{ nvim.repo_path }}/build"

- name: "Move Neovim binary to the specified path"
  ansible.builtin.command:
    cmd: mv {{ nvim.repo_path}}/nvim {{ nvim.bin_path }}
    creates: "{{ nvim.bin_path }}/nvim"
